<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Sync</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>
    <div id="main-container">
        <!-- Left Section: YouTube Player -->
        <div id="video-container">
            <div id="video-player"></div>
        </div>

        <!-- Center Section: Playback Controls -->
        <div id="controls-container">
            <div id="seek-bar-container">
                <button id="prev-btn">«</button>
                <input type="range" id="seek-bar" value="0">
                <button id="next-btn">»</button>
            </div>
            <div id="play-pause-container">
                <button id="play-pause-btn">▶</button>
            </div>
            <div id="search-container">
                <input type="text" id="search-input" placeholder="Search YouTube...">
                <button id="search-button">Search</button>
            </div>
        </div>

        <!-- Right Section: Authentication -->
        <div id="auth-container">
            <button id="login-btn">Sign In</button>
            <button id="logout-btn" style="display:none;">Sign Out</button>
        </div>
    </div>

    <script>
        let player;
        let isPlaying = false;

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('video-player', {
                height: '270',
                width: '480',
                playerVars: { 'autoplay': 0, 'controls': 0 },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        function onPlayerReady(event) {
            document.getElementById("play-pause-btn").addEventListener("click", togglePlayPause);
            document.getElementById("prev-btn").addEventListener("click", () => console.log("Prev Clicked"));
            document.getElementById("next-btn").addEventListener("click", () => console.log("Next Clicked"));
        }

        function onPlayerStateChange(event) {
            if (event.data == YT.PlayerState.PLAYING) {
                isPlaying = true;
                document.getElementById("play-pause-btn").textContent = "⏸";
            } else {
                isPlaying = false;
                document.getElementById("play-pause-btn").textContent = "▶";
            }
        }

        function togglePlayPause() {
            if (isPlaying) {
                player.pauseVideo();
            } else {
                player.playVideo();
            }
        }

        document.getElementById("search-button").addEventListener("click", function () {
            let query = document.getElementById("search-input").value;
            searchYouTube(query);
        });

        function searchYouTube(query) {
            gapi.client.init({
                apiKey: "AIzaSyBFfY5CZScu8FdE2oLjaCTQ3H5WbAQXos8",
                discoveryDocs: ["https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest"]
            }).then(function () {
                return gapi.client.youtube.search.list({
                    part: "snippet",
                    q: query,
                    type: "video",
                    maxResults: 1
                });
            }).then(function (response) {
                let videoId = response.result.items[0].id.videoId;
                player.loadVideoById(videoId);
            }).catch(function (err) {
                console.error("YouTube Search Error:", err);
            });
        }

        gapi.load("client");

        document.getElementById("login-btn").addEventListener("click", function () {
            console.log("Login Clicked");
        });

        document.getElementById("logout-btn").addEventListener("click", function () {
            console.log("Logout Clicked");
        });

        let tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        document.head.appendChild(tag);
    </script>
</body>
</html>
